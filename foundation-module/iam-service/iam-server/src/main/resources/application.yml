# Synapse 配置
synapse:
  databases:
    # 使用SQL注解功能（推荐）
    sql-annotation:
      enabled: true
    # 禁用auto-repository避免冲突
    auto-repository:
      enabled: false
  datasource:
    mybatis-plus:
      configuration:
        log-impl: org.apache.ibatis.logging.stdout.StdOutImpl
        map-underscore-to-camel-case: true
      global-config:
        banner: false
    primary: master1
    # 字段转换配置
    field-conversion:
      enabled: true
      strategy: CAMEL_TO_UNDERLINE
    # 数据源配置
    datasources:
      master1:
        type: MYSQL
        host: 10.80.3.24
        port: 6450
        database: synapse_iam
        username: xmom
        password: 123456
        pool-type: HIKARI
        role: READ_WRITE  # 读写数据源
        weight: 100       # 权重
        params:
          useUnicode: "true"
          characterEncoding: "utf8"
          useSSL: "false"
          allowPublicKeyRetrieval: "true"
          serverTimezone: "Asia/Shanghai"
          autoReconnect: "true"
          failOverReadOnly: "false"
          maxReconnects: "3"
          initialTimeout: "2"
        hikari:
          minimum-idle: 5
          maximum-pool-size: 15
          idle-timeout: 30000
          max-lifetime: 1800000
          connection-timeout: 30000
          # 添加连接验证
          connection-test-query: "SELECT 1"
          validation-timeout: 5000
      master2:
        type: MYSQL
        host: 10.80.3.25
        port: 6450
        database: synapse_iam
        username: xmom
        password: 123456
        pool-type: HIKARI
        role: READ_WRITE  # 读写数据源
        weight: 100       # 权重
        params:
          useUnicode: "true"
          characterEncoding: "utf8"
          useSSL: "false"
          allowPublicKeyRetrieval: "true"
          serverTimezone: "Asia/Shanghai"
          autoReconnect: "true"
          failOverReadOnly: "false"
          maxReconnects: "3"
          initialTimeout: "2"
        hikari:
          minimum-idle: 5
          maximum-pool-size: 15
          idle-timeout: 30000
          max-lifetime: 1800000
          connection-timeout: 30000
          # 添加连接验证
          connection-test-query: "SELECT 1"
          validation-timeout: 5000
    seata:
      enabled: false
  security:
    enabled: true
    jwt:
      enabled: true
      secret: SynapseMOM@2024!SecureJWTKey#256
      expiration: 1800
      prefix: Bearer
  cache:
    enabled: true
    default-strategy: "LOCAL_AND_REDIS"
    redis-cache:
      sentinel:
        enabled: true
        master: mymaster
        nodes:
          - 10.80.3.21:26379
          - 10.80.3.22:26379
          - 10.80.3.23:26379
          - 10.80.3.24:26379
          - 10.80.3.25:26379
      #      enabled: true
      #      connection:
      #        host: localhost
      #        port: 6379
      #        database: 0
      #        timeout: PT2S
      connection-timeout: PT5S
      pool:
        max-active: 8
        max-idle: 8
        min-idle: 0
        max-wait: PT-1S
      enabled: true
  events:
    enabled: false

# 日志配置
logging:
  level:
    root: INFO
    com.indigo: INFO
    com.indigo.databases: INFO
    com.indigo.security: INFO

mybatis-plus:
  configuration:
    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl
    map-underscore-to-camel-case: true
  ## 管理端点
  global-config:
    banner: false